\chapter{Ομαδοποίηση}
\section{Διαχωριστικοί Αλγόριθμοι}

Ο αλγόριθμος που κυρίως αντιπροσωπεύει αυτή την κατηγορία αλγορίθμων είναι ο K-means. Η βασική ιδέα των διαχωριστικών αλγορίθμων είναι η ανάθεση των σημείων μας σε ομάδες προσπαθώντας να ελαχιστοποιήσουμε την απόσταση από ένα σημείο που αντιπροσωπεύει την ομάδα. Έτσι κάθε σημείο μας θεωρούμε ότι ανήκει στην ομάδα αυτή στην οποία η απόσταση από το αντιπροσωπευτικό σημείο είναι ελάχιστη. Εκτός από τον K-means σε αυτήν την κατηγορία ανήκουν διάφορες παραλλαγές του όπως ο bisection K-means ,ο fuzzy Κ-means και ο K-medoid. Στην δικιά μας υλοποίηση χρησιμοποιήσαμε τον απλό K-means και τον K-medoid.

\subsection{K-means}

Όπως αναφέραμε ο K-means είναι ο πιο συνηθισμένος και απλός διαχωριστικός αλγόριθμος. Η λογική που χρησιμοποιεί είναι η εξής:
\begin{enumerate}
	\item Κάθε ομάδα συνδέεται με ένα κέντρο (centroid) το οποίο είναι το αντιπροσωπευτικό σημείο της ομάδας.
	\item Κάθε σημείο αποδίδεται στην ομάδα με το πιο κοντινό κέντρο ελαχιστοποιώντας την μεταξύ τους απόσταση. 
	\item Ο αριθμός των ομάδων Κ πρέπει να έχει καθοριστεί από πριν.
\end{enumerate}

Πιο συγκεκριμένα μπορούμε να αναλύσουμε τα βήματα του αλγορίθμου που ακολουθούμε ως εξής:
\begin{enumerate}
	\item Επιλέγουμε k σημεία ως αρχικά κέντρα.
	\item Δημιουργούμε k ομάδες με τον τρόπο που περιγράφτηκε.
	\item Υπολογίζουμε τα νέα κέντρα των ομάδων μας.
	\item Επαναλαμβάνουμε τα βήματα 2-3 μέχρις ώτου δεν μεταβληθούν τα κέντρα.
\end{enumerate}

Παρακάτω παρουσιάζεται ο αλγόριθμος K-means σε ψευδογλώσσα:

\begin{algorithmic}[H]
	\State Select K points as the initial centroids.
	\Do
	\State Form K clusters by assigning all points to the closest centroid.
	\State Recompute the centroid of each cluster.
	\doWhile{The centroids dont change} % <--- use \doWhile for the "while" at the end
\end{algorithmic}

Αφού περιγράψαμε τις βασικές ιδέες του αλγορίθμου K-means μπορούμε πλέον να προχωρήσουμε σε ορισμένα σημαντικά θέματα που αφορούν τον αλγόριθμο K-means. Αυτά είναι ο αριθμός των ομάδων, η επιλογή των αρχικών κέντρων και ο τρόπος υπολογισμού της απόστασης.Ο τελικός αριθμός των ομάδων στην περίπτωση μας είναι ίσος με 8. Μπορούμε να δημιουργήσουμε περισσότερες ή λιγότερες ομάδες αρχικά και σταδιακά να φτάσουμε στον τελικό αριθμό. Όσον αφορά το θέμα της επιλογής των αρχικών κέντρων υπάρχουν διάφορες τεχνικές αντιμετώπισης αυτού του προβλήματος. Τα αρχικά κέντρα συνήθως επιλέγονται τυχαία. Αν και συνήθως αυτοί οι αλγόριθμοι συγκλίνουν με τυχαία επιλογή κέντρων υπάρχει πάντα η πιθανότητα να πέσουμε σε τοπικό ελάχιστο της προς ελαχιστοποίηση συνάρτησης. Για αυτόν τον λόγο χρησιμοποιήθηκαν 2 τρόποι αντιμετώπισης του προβλήματος των αρχικών τιμών. 
\begin{enumerate}
	\item Τυχαία αρχικοποίηση των centroids αλλά επιλέγοντας να τρέξει πολλές φορές ο K-means. Έτσι ουσιαστικά τρέχουμε πολλές φορές τον αλγόριθμο ομαδοποίησης και επιλέγουμε κάθε φορά αυτόν που μας δίνει το ελάχιστο σφάλμα.
	\item Heuristic Μέθοδος επιλογής centroids. Υπάρχουν διάφορες τεχνικές επιλογής αρχικού κέντρου με Heuristic μεθόδους που προκύπτουν από την εμπειρία μας. Η τεχνική που χρησιμοποιήσαμε εμείς ακολουθά την παρακάτω λογική και έχει ως σκοπό την επιλογή Κ centroid, όσες και οι ομάδες μας. Επιλέγουμε σαν αρχική τιμή centroid το σημείο από τα δεδομένα μας που βρίσκεται πιο κοντά στον μέσο όρο των σημείων μας. Έτσι έχουμε ένα centroid. Για το επόμενο υπολογίζουμε τις αποστάσεις των σημείων μας από το centroid και ορίζουμε αυτό που βρίσκεται πιο μακριά από το centroid. Έτσι έχουμε 2 centroids. Όμοια προχωράμε επιλέγοντας σαν επόμενο centroid αυτό που απέχει περισσότερο από τα ήδη επιλεγμένα centroid. Συνεχίζουμε έτσι μέχρις ώτου επιλέξουμε K centroids. Αναλυτικά τα βήματα του αλγορίθμου:
	
	\begin{algorithmic}[H]
		\State Step1: From n objects calculate a point whose attribute values are average of n-objects atrribute values so first initial centroid is average of n-objects.
		\State
	    \State Step2: Select next initial centroids from n-objects in such a way that the Euclidean distance of that object is maximum from other selected initial centroids.
	    \State
	    \State Step3: Repeat step2 until we get k initial centroids.
	    \State
	    \State From these steps we will get initial centroids and with these initial centroids perform K-means algorithm.
	\end{algorithmic}
\end{enumerate}

Ακόμα για να αποφύγουμε το πρόβλημα των αρχικών centroids πολλές φορές χρησμιποιείται ο bisecting K-means καθώς εξαρτάται λιγότερο από την αρχική επιλογή των κεντρών.

Η πολυπλοκότητα του αλγορίθμου είναι Ο(n*K*I*d) όπου n=αριθμός σημείων, Κ=αριθμός ομάδων, l=αριθμός επαναλήψεων , d=αριθμός μεταβλητών. Πρόκειται για έναν αρκετά γρήγορο αλγόριθμο.

Τέλος η τελευταία παράμετρος που επιλέγεται στον αλγόριθμο K-means είναι η απόσταση. Οι μετρικές που χρησιμοποιούνται σαν απόσταση είναι:
\begin{enumerate}
	\item \textbf{Ευκλείδια(euclidean) }: H κλασική ευκλίδεια απόσταση
	\item \textbf{Τετραγωνική Ευκλείδια(sqeuclidean) }: Τετραγωνική ευκλείδια απόσταση.
	\item \textbf{Cityblock }: To άθροισμα της απόλυτης διαφόρας γνωστή και ως $L1$ απόσταση.
	\item \textbf{Cosine }: Απόσταση που εμπεριέχει το συνημίτονο της γωνίας των σημείων.
	\item \textbf{Correlation }: Απόσταση που εμπεριέχει την συσχέτηση των σημείων.
	\item \textbf{Hamming }: Απόσταση που χρησιμοποιείται για δυαδικά δεδομένα. Είναι το ποσοστό των bit που διαφέρουν.
\end{enumerate}

Παρακάτω φαίνεται μια ομαδοποίηση που πραγματοποιήθηκε με K-means. Είναι ευδιάκριτα τόσο τα 3 clusters που δημιουργήθηκαν όσο και τα κέντρα τους. Κάθε σημείο του κάθε cluster απέχει την ελάχιστη απόσταση από το κέντρο του cluster στο οποιό ανήκει.

	\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{../../../../../Dropbox/protypa-figs/pictures-2/kmeans}
\caption{}
\label{fig:kmeans}
\end{figure}


Τέλος βλέπουμε ένα παράδειγμα μιας ομαδοποίησης ενός dataset μέσω του αλγορίθμου K-means ανάλογα με το βήμα στο οποίο βρίσκεται. Βλέπουμε πως μεταβάλλονται τα κέντρα με το πέρασμα των επαναλήψεων και έτσι και τα σημεία που ανήκουν σε κάθε cluster. Στο τελευταίο βήμα παρατηρούμε πάλι ότι το σημείο κάθε cluster απέχει ελάχιστη απόσταση από το κέντρο του cluster στο οποίο βρίσκεται και συνεπώς δεν χρειάζεται να γίνει άλλη επανάληψη και ο αλγόριθμος έχει τερματιστεί.

\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{../../../../../Dropbox/protypa-figs/pictures-2/kmeans_change_centroids}
\caption{}
\label{fig:kmeans_change_centroids}
\end{figure}



